extends layout

block styles
    link(rel='stylesheet' href="/css/visualization.css")
    link(rel='stylesheet' href="/css/patterns.css")
    link(rel='stylesheet' href="/css/d3-context-menu.css")
    link(rel="icon" type="image/png" href="resources/favicon_visualization.png")

block pre_scripts
    // d3.js
    script(src="https://d3js.org/d3.v5.min.js")
    script(src="scripts/additional-modules/d3-context-menu.js")
    // framework
    script(src='scripts/visualization/main.js')
    script(src='scripts/visualization/dataset.js')
    script(src='scripts/visualization/visualization.js')
    script(src='scripts/visualization/boxmanager.js')
    script(src='scripts/visualization/box.js')
    script(src='scripts/visualization/properties.js')
    script(src='scripts/visualization/styles.js')
    script(src='scripts/visualization/registry.js')
    // visualizations
    script(src='scripts/visualization/transitiongraph.js')
    script(src='scripts/visualization/eyecloud.js')
    script(src='scripts/visualization/gazestripe.js')
    script(src='scripts/visualization/attentionmap.js')
    script(src='scripts/visualization/editor.js')

block sidebars
    //-  Settings Sidebar -//
    div(class="ui sidebar right vertical menu settings")
        div(class="item left aligned small-right-padding")
            div(class="ui header") Settings:
                i(class="ui times red inverted icon circular small fitted right-float" onclick="closeSettings()")
        //-  Visualization type(s) -//
        div(class="item")
            div(class="ui styled accordion")
                div(class="active title")
                    div(class="ui teal tiny basic circular label exclude settinghelp" onclick="settingHelp('Visualizations')")
                        i(class="ui fitted question icon exclude")
                    i(class="ui dropdown icon")
                    label Visualizations:
                div(class="ui form content active")
                    div(class="grouped fields left-align")
                        //- Eye Cloud -//
                        div(class="field")
                            div(class="ui toggle checked checkbox")
                                input(type="checkbox" id="eyecloud" class="settings visualization_type" checked="")
                                label(for="eyecloud") Eye Cloud
                        //- Gaze Strips -//
                        div(class="field")
                            div(class="ui toggle checked checkbox")
                                input(type="checkbox" id="gazestripe" class="settings visualization_type" checked="")
                                label(for="gazestripe") Gaze Stripes
                        //- Transition Graph -//
                        div(class="field")
                            div(class="ui toggle checked checkbox")
                                input(type="checkbox" id="transitiongraph" class="settings visualization_type" checked="")
                                label(for="transitiongraph") Transition Graph
                        //- Visual Attention Map -//
                        div(class="field")
                            div(class="ui toggle checked checkbox")
                                input(type="checkbox" id="attentionmap" class="settings visualization_type" checked="")
                                label(for="attentionmap") Visual Attention Map
                        div(class="ui fitted divider")
                        //- Editor -//
                        div(class="field")
                            div(class="ui toggle checked checkbox")
                                input(type="checkbox" id="editor" class="settings visualization_type" checked="")
                                label(for="editor") Editor
        //- Image Selection -//
        //- Default image setDefaultImageHere -//
        -var default_image = "01b_Antwerpen_S2.jpg"
        script.let image = "#{default_image}";

        div(class="item")
            div(class="ui styled accordion")
                div(class="active title")
                    div(class="ui teal tiny basic circular label exclude settinghelp" onclick="settingHelp('Image')")
                        i(class="ui fitted question icon exclude")
                    i(class="ui dropdown icon")
                    label Image:
                div(class="ui form content active")
                    //- Dropdown selection menu -//
                    div(class="ui fluid search selection dropdown image")
                        div(class="default text") #{default_image}
                        i(class="ui dropdown icon")
                        div(class="menu")
                            //- Add all filenames to the dropdown; text: filename, data-value:tags[filename] -//
                            for image in images
                                div(class="item fitted image-selector" data-value=tags[image]) #{image}
                            else
                                div(class="item") No images were found

        //- User Selection -//
        div(class="item")
            div(class="ui styled accordion")
                div(class="active title" data-tooltip="Not working yet!")
                    div(class="ui teal tiny basic circular label exclude settinghelp" onclick="settingHelp('Users')")
                        i(class="ui fitted question icon exclude")
                    i(class="ui dropdown icon")
                    label Users:
                div(class="ui form content active")
                    //- Dropdown selection menu -//
                    div(class="ui fluid search selection multiple dropdown user")
                        div(class="default text") Select users
                        i(class="ui dropdown icon")
                        div(class="menu")
                            //- Values are added in initiatesettings.js -//
                            div(class="item") No users were found
                    div(class="ui clear circular red basic button")
                        i(class="ui remove fitted icon")
        //- RGBA -//
        div(class="item")
            div(class="ui styled accordion colorsettings")
                div(class="inline active title")
                    div(class="ui teal tiny basic circular label exclude settinghelp" onclick="settingHelp('Color')")
                        i(class="ui fitted question icon exclude")
                    i(class="ui dropdown icon")
                    label Color:
                    //- Color Preview Icon -//
                    i(class="ui inverted circular eye dropper icon color-preview")
                div(class="ui form content active ")
                    //- Red Slider -//
                    div(class="ui inline fields")
                        div(class="ui inverted label r-color-preview") R
                        div(class="ui slider rgb small-padding" id="r")
                    //- Green Slider -//
                    div(class="ui inline fields")
                        div(class="ui inverted label g-color-preview") G
                        div(class="ui slider rgb small-padding" id="g")
                    //- Blue Slider -//
                    div(class="ui inline fields")
                        div(class="ui inverted label b-color-preview") B
                        div(class="ui slider rgb small-padding" id="b")
                    //- Alpha Slider (Disabled for now) Remove from scripts if not used!-//
                        div(class="ui inline fields")
                            div(class="ui inverted label a-color-preview") A
                            div(class="ui slider small-padding alpha" id="a") 


        //- Editor Mode -//
        div(class="item")
                div(class="ui styled accordion editorsettings")
                    div(class="inline active title")
                        div(class="ui teal tiny basic circular label exclude settinghelp" onclick="settingHelp('Editor')")
                            i(class="ui fitted question icon exclude")
                        i(class="ui dropdown icon")
                        label Editor Commands:
                    div(class="ui form content active ")
                        p  
                        |  Use middle click to move the image around
                        |  <br>  <br>
                        |  In brush mode, you can create AOI by holding left click button
                        |  <br>  <br>
                        |  Use the context menu by pressing right click to switch between brush mode and view mode 

        //- Zoom Level -//
        div(class="item")
            div(class="ui styled accordion zoomsettings")
                div(class="inline active title")
                    div(class="ui teal tiny basic circular label exclude settinghelp" onclick="settingHelp('Zoom')" data-position="top left" data-inverted="" data-variation="tiny basic")
                        i(class="ui fitted question icon exclude")
                    i(class="ui dropdown icon")
                    label Zoom Level:
                div(class="ui form content active ")
                    div(class="ui slider zoom small-padding")


        //- Apply Settings & Auto Apply -//
        div(class="ui basic center aligned fitted segment")
            div(class="field")
                div(class="ui green basic button" onclick="applySettings()") Apply Settings
                div(class="ui checkbox")
                    input#auto_apply(type="checkbox" name="auto_apply_settings" checked=":checked")
                    label(for="auto_apply") Apply On Change

            div#show_help(class="ui green basic circular button bottom floated" onclick="showHelp()" data-tooltip="Toggle help icons" data-position="top left" data-inverted="" data-variation="tiny basic")
                i(class="ui fitted question icon")



block header_content
    //- Topbar Centered Text -//
    div(class="ui item")
        div(class="ui center aligned container")
            div#topbar(class="ui large header selectable")
    //-  Settings Sidebar Button -//
    div(class="ui item")
        div(class="ui right aligned container" style="margin-right:5px;")
            i#settings_toggle(class="ui sliders icon circular fitted" onclick="openSettings()")

block content
    div#container(class='container')
        div#frame(class='frame')
            div(class="preview ui big centered image" style="display:none;")
                img#preview-image(src="/testdataset/images/" + default_image)
            div#innerframe(class='inner-frame')

block post_scripts
    //- Settings Sidebar behaviors -//
    script.
        function openSettings() {
            $('#settings_toggle')
                //- Hide Icon -//            
                .hide();
            //- Open Settings -//
            showSidebar('settings');
            //resizeBoxes()
        };

        function closeSettings() {
            $('#settings_toggle')
                //- Unhide Icon -//
                .show();
            //- Close Settings -//
            hideSidebar('settings');
            //resizeBoxes()
        };

        //- Prevent 'settings' sidebar from dimming the page -//
        $('.ui.sidebar.settings').sidebar({dimPage: false, closable: false})

    //- Load settings scripts -//
    script(src='scripts/visualization/readsettings.js')
    script(src="scripts/visualization/initiatesettings.js")

    //- Set Active page to Visualization in 'navigation' sidebar -//
    script.
        $('#visualization_nav').addClass('active');